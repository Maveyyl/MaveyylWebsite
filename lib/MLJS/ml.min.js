/*! ml 2.0.0 2016-07-01 */
var ml=function(){function a(a,b,c,d,e){this.has_weights=!0,this.input_unit_count=a+1,this.output_unit_count=b,this.weight_init_f=c,this.activation_f=d,this.activation_f_derivative=e,this.weights=new Array(this.output_unit_count),this.weight_count=this.output_unit_count*this.input_unit_count;var f,g;for(g=0;g<this.output_unit_count;g++)for(this.weights[g]=new Array(this.input_unit_count),f=0;f<this.input_unit_count;f++)this.weights[g][f]=c(this.input_unit_count,this.output_unit_count)}function b(a){this.has_weights=!1,this.unit_count=a}function c(a,b,c,d){this.has_weights=!0,this.input_unit_count=a.input_unit_count,this.output_unit_count=a.output_unit_count,this.window_unit_count=a.window_unit_count,this.window_slide_range=a.window_slide_range,this.IZ=this.input_unit_count[0],this.IR=this.input_unit_count[1],this.IC=this.input_unit_count[2],this.WR=this.window_unit_count[0],this.WC=this.window_unit_count[1],this.OZ=this.output_unit_count[0],this.OR=this.output_unit_count[1],this.OC=this.output_unit_count[2],this.weight_init_f=b,this.activation_f=c,this.activation_f_derivative=d;var e,f,g,h;for(this.weight_count=this.OZ+this.OZ*this.IZ*this.WR*this.WC,this.weights=new Array(this.OZ),this.bias_weights=new Array(this.OZ),h=0;h<this.OZ;h++)for(this.bias_weights[h]=b(this.IZ*this.WR*this.WC,this.OZ*this.WR*this.WC),this.weights[h]=new Array(this.IZ),e=0;e<this.IZ;e++)for(this.weights[h][e]=new Array(this.WR),f=0;f<this.WR;f++)for(this.weights[h][e][f]=new Array(this.WC),g=0;g<this.WC;g++)this.weights[h][e][f][g]=b(this.IZ*this.WR*this.WC,this.OZ*this.WR*this.WC)}function d(a){this.has_weights=!1,this.input_unit_count=a.input_unit_count,this.output_unit_count=a.output_unit_count,this.window_unit_count=a.window_unit_count,this.IZ=this.input_unit_count[0],this.IR=this.input_unit_count[1],this.IC=this.input_unit_count[2],this.WR=this.window_unit_count[0],this.WC=this.window_unit_count[1],this.OZ=this.output_unit_count[0],this.OR=this.output_unit_count[1],this.OC=this.output_unit_count[2]}function e(a,b){this.cost_f=a,this.cost_f_derivative=b,this.layers=[],this.layer_count=0}function f(a){this.config={},this.config.learning_rate=a.learning_rate||0,this.config.stop_criteria=a.stop_criteria||.001,this.config.min_iter=a.min_iter||100,this.config.max_iter=a.max_iter||1e3,this.config.regularization_parameter=a.regularization_parameter||0,this.config.gradient_check_parameter=a.gradient_check_parameter||1e-4,this.config.feature_scalling=void 0!==a.feature_scalling?a.feature_scalling:!1,this.config.alpha=this.config.learning_rate,this.config.lambda=this.config.regularization_parameter,this.config.epsilon=this.config.gradient_check_parameter}var g={},h=function(){function a(a){for(var b=[],c=a;void 0!==c&&void 0!==c.length;)b.push(c.length),c=c[0];return b}function b(a){var b=Math.log(a);return b===-(1/0)&&(b=-Number.MAX_VALUE),b}return{matrix_size:a,log:b}}();g.utils=h;var j=function(){function a(a){var b,c,d,e=a.length,f=a[0].length,g=new Array(f).fill(0),h=new Array(f).fill(0);for(d=0;f>d;d++){for(c=1;e>c;c++)g[d]+=a[c][d];g[d]=g[d]/e}for(d=0;f>d;d++){for(c=0;e>c;c++)h[d]+=a[c][d]*a[c][d];h[d]=h[d]/e,h[d]=h[d]-g[d]*g[d],h[d]=Math.sqrt(h[d])}for(b=new Array(e),c=0;e>c;c++)for(b[c]=new Array(f),d=0;f>d;d++)b[c][d]=(a[c][d]-g[d])/h[d];return{matrix:a,feature_scalling_parameters:{mean:g,std:h}}}function b(a,b){var c,d,e,f=a.length,g=a[0].length,h=0;for(c=0;f>c;c++)for(d=0;g>d;d++)e=a[c][d]-b[c][d],h+=e*e;return h/=2*f}function c(a,b,c,d){var e,f,g=a.length,h=a[0].length,i=new Array(g);if(d)for(e=0;g>e;e++)for(i[e]=new Array(h),f=0;h>f;f++)i[e][f]=(a[e][f]-b[e][f])*d(c[e][f]);else for(e=0;g>e;e++)for(i[e]=new Array(h),f=0;h>f;f++)i[e][f]=a[e][f]-b[e][f];return i}function d(a,b){var c,d,e=a.length,f=a[0].length,h=0;for(c=0;e>c;c++)for(d=0;f>d;d++)h+=b[c][d]*g.utils.log(a[c][d])+(1-b[c][d])*g.utils.log(1-a[c][d]);return h=-1*h/e}function e(a,b,c,d){var e,f,g=a.length,h=a[0].length,i=new Array(g);for(e=0;g>e;e++)for(i[e]=new Array(h),f=0;h>f;f++)i[e][f]=a[e][f]-b[e][f];return i}function f(a){return 0>a?0:a}function h(a){return 0>a?0:1}function i(a){var b=1/(1+Math.exp(-a));return b}function j(a){var b=i(a);return b*(1-b)}return{feature_scalling:a,MSE:b,MSE_derivative:c,cross_entropy:d,cross_entropy_derivative:e,ReLU:f,ReLU_derivative:h,sigmoid:i,sigmoid_derivative:j}}();return g.ml_utils=j,g.FullyConnectedLayer=a,g.fully_connected_layer_debug=!1,a.prototype.forward_propagation=function(a){var b,c,d,e=a.length,f=new Array(e),h=new Array(e);for(b=0;e>b;b++)for(f[b]=new Array(this.output_unit_count).fill(0),h[b]=new Array(this.output_unit_count),d=0;d<this.output_unit_count;d++){for(f[b][d]+=this.weights[d][0],c=1;c<this.input_unit_count;c++)f[b][d]+=a[b][c-1]*this.weights[d][c];this.activation_f?h[b][d]=this.activation_f(f[b][d]):h[b][d]=f[b][d]}return g.fully_connected_layer_debug&&(console.log("forward_propagation"),console.log("A:",h),console.log("Z:",f)),{A:h,Z:f}},a.prototype.backward_propagation=function(a,b,c,d){var e,f,h,i=a.length,j=new Array(i);for(h=0;i>h;h++)for(j[h]=new Array(this.input_unit_count-1).fill(0),e=1;e<this.input_unit_count;e++){for(f=0;f<this.output_unit_count;f++)j[h][e-1]+=a[h][f]*this.weights[f][e];d&&(j[h][e-1]*=d(c[h][e-1]))}return g.fully_connected_layer_debug&&(console.log("backward_propagation"),console.log("D:",a),console.log("Z:",c),console.log("DM:",j)),j},a.prototype.compute_gradient=function(a,b){var c,d,e,f=a.length,h=new Array(this.output_unit_count);for(d=0;d<this.output_unit_count;d++){for(h[d]=new Array(this.input_unit_count).fill(0),c=0;f>c;c++)for(h[d][0]+=a[c][d],e=1;e<this.input_unit_count;e++)h[d][e]+=a[c][d]*b[c][e-1];for(h[d][0]/=f,e=1;e<this.input_unit_count;e++)h[d][e]/=f}var i=this.unroll_weights(h);return g.fully_connected_layer_debug&&(console.log("compute_gradient"),console.log("D:",a),console.log("A:",b)),i},a.prototype.weights_update=function(a,b){var c=this.roll_weights(a);for(i=0;i<this.input_unit_count;i++)for(o=0;o<this.output_unit_count;o++)this.weights[o][i]-=b*c[o][i]},a.prototype.unroll_weights=function(a){var b,c,d,e=new Array(this.weight_count);for(b=0,c=0;c<this.output_unit_count;c++)for(d=0;d<this.input_unit_count;d++)e[b]=a[c][d],b++;return e},a.prototype.roll_weights=function(a){var b,c;b=0;var d=new Array(this.output_unit_count);for(c=0;c<this.output_unit_count;c++)d[c]=a.slice(b,b+this.input_unit_count),b+=this.input_unit_count;return d},a.prototype.set_weight=function(a,b,c){var d,e;e=b%this.input_unit_count,d=Math.floor(b/this.input_unit_count),a[d][e]=c},a.prototype.get_weight=function(a,b){var c,d;return d=b%this.input_unit_count,c=Math.floor(b/this.input_unit_count),a[c][d]},a.prototype.is_weight_bias=function(a){var b=a%this.input_unit_count;return 0===b},g.SoftmaxLayer=b,g.softmax_layer_debug=!1,b.prototype.forward_propagation=function(a){var b,c,d,e,f=a.length,h=0,i=new Array(f);for(b=0;f>b;b++){for(h=0,e=new Array(this.unit_count),i[b]=new Array(this.unit_count),c=0;c<this.unit_count;c++)e[c]=Math.exp(a[b][c]),h+=e[c];for(d=0;d<this.unit_count;d++)i[b][d]=e[d]/h}return g.softmax_layer_debug&&(console.log("forward_propagation"),console.log("X:",a),console.log("A:",i)),{A:i,Z:a}},b.prototype.backward_propagation=function(a,b,c,d){var e,f,h,i=a.length,j=new Array(i);for(h=0;i>h;h++)for(j[h]=new Array(this.unit_count).fill(0),e=0;e<this.unit_count;e++){for(f=0;f<this.unit_count;f++)e===f?j[h][e]+=a[h][e]*(1-a[h][f]):j[h][e]+=-(a[h][e]*a[h][f]);d&&(j[h][e]*=d(c[h][e]))}return g.softmax_layer_debug&&(console.log("backward_propagation"),console.log("D:",a),console.log("Z:",c),console.log("DM:",j)),j},g.ConvLayer=c,g.conv_layer_debug=!1,c.prototype.forward_propagation=function(a){var b=a.length;g.conv_layer_debug&&(console.log("forward_propagation"),console.log("X:",a)),a=this.roll_matrix(a,[b,this.IZ,this.IR,this.IC]);var c,d,e,f,h,i,j,k,l;for(Z=new Array(b),A=new Array(b),c=0;b>c;c++)for(Z[c]=new Array(this.OZ),A[c]=new Array(this.OZ),h=0;h<this.OZ;h++)for(Z[c][h]=new Array(this.OR),A[c][h]=new Array(this.OR),i=0;i<this.OR;i++)for(Z[c][h][i]=new Array(this.OC).fill(0),A[c][h][i]=new Array(this.OC),k=i*this.window_slide_range[0],j=0;j<this.OC;j++){for(Z[c][h][i][j]+=this.bias_weights[h],l=j*this.window_slide_range[1],d=0;d<this.IZ;d++)for(e=0;e<this.WR;e++)for(f=0;f<this.WC;f++)Z[c][h][i][j]+=a[c][d][k+e][l+f]*this.weights[h][d][e][f];this.activation_f?A[c][h][i][j]=this.activation_f(Z[c][h][i][j]):A[c][h][i][j]=Z[c][h][i][j]}return A=this.unroll_matrix(A,[b,this.OZ,this.OR,this.OC]),Z=this.unroll_matrix(Z,[b,this.OZ,this.OR,this.OC]),g.conv_layer_debug&&(console.log("Z:",Z),console.log("A:",A)),{A:A,Z:Z}},c.prototype.backward_propagation=function(a,b,c,d){var e=a.length;g.conv_layer_debug&&(console.log("backward_propagation"),console.log("D:",a),console.log("Z:",c)),a=this.roll_matrix(a,[e,this.OZ,this.OR,this.OC]),c=this.roll_matrix(c,[e,this.IZ,this.IR,this.IC]);var f,h,i,j,k,l,m,n,o,p,q,r=new Array(e);for(f=0;e>f;f++){for(r[f]=new Array(this.IZ),h=0;h<this.IZ;h++)for(r[f][h]=new Array(this.IR),i=0;i<this.IR;i++)r[f][h][i]=new Array(this.IC).fill(0);for(h=0;h<this.IZ;h++)for(k=0;k<this.WR;k++)for(l=0;l<this.WC;l++)for(m=0;m<this.OZ;m++)for(n=0;n<this.OR;n++)for(q=n*this.window_slide_range[0],o=0;o<this.OC;o++)p=o*this.window_slide_range[1],r[f][h][q+k][p+l]+=a[f][m][n][o]*this.weights[m][h][k][l];if(d)for(h=0;h<this.IZ;h++)for(i=0;i<this.IR;i++)for(j=1;j<this.IC;j++)r[f][h][i][j]*=d(c[f][h][i][j])}return r=this.unroll_matrix(r,[e,this.IZ,this.IR,this.IC]),g.conv_layer_debug&&console.log("DM:",r),r},c.prototype.compute_gradient=function(a,b){var c=a.length;g.conv_layer_debug&&(console.log("compute_gradient"),console.log("D:",a),console.log("A:",b)),a=this.roll_matrix(a,[c,this.OZ,this.OR,this.OC]),b=this.roll_matrix(b,[c,this.IZ,this.IR,this.IC]);var d,e,f,h,i,j,k,l,m,n=new Array(this.OZ).fill(0),o=new Array(this.OZ);for(i=0;i<this.OZ;i++){for(d=0;c>d;d++)for(j=0;j<this.OR;j++)for(k=0;k<this.OC;k++)n[i]+=a[d][i][j][k];for(n[i]/=c,o[i]=new Array(this.IZ),e=0;e<this.IZ;e++)for(o[i][e]=new Array(this.WR),f=0;f<this.WR;f++)for(o[i][e][f]=new Array(this.WC).fill(0),h=0;h<this.WC;h++){for(j=0;j<this.OR;j++)for(m=j*this.window_slide_range[0],k=0;k<this.OC;k++)for(l=k*this.window_slide_range[1],d=0;c>d;d++)o[i][e][f][h]+=a[d][i][j][k]*b[d][e][m+f][l+h];o[i][e][f][h]/=c}}var p=this.unroll_weights(o,n);return g.conv_layer_debug&&(console.log("D:",a),console.log("A:",b)),p},c.prototype.weights_update=function(a,b){var c,d,e,f,g=(this.roll_weights(a),this.roll_bias_weights(a));for(f=0;f<this.OZ;f++)for(this.bias_weights[f]-=b*g[f],c=0;c<this["this"];c++)for(d=0;d<this.WR;d++)for(e=0;e<this.WC;e++)this.weights[f][c][d][e]-=b*a[f][c][d][e]},c.prototype.unroll_matrix=function(a,b){for(var c=new Array(b[0]),d=0,e=0;e<b[0];e++){c[e]=new Array(b[1]*b[2]*b[3]);for(var f=0;f<b[1];f++)for(var g=0;g<b[2];g++)for(var h=0;h<b[3];h++)c[e][d]=a[e][f][g][h],d++;d=0}return c},c.prototype.roll_matrix=function(a,b){for(var c=new Array(b[0]),d=0,e=0;e<b[0];e++){c[e]=new Array(b[1]);for(var f=0;f<b[1];f++){c[e][f]=new Array(b[2]);for(var g=0;g<b[2];g++)c[e][f][g]=a[e].slice(d,d+b[3]),d+=b[3]}d=0}return c},c.prototype.unroll_weights=function(a,b){var c,d,e,f,g,h=new Array(this.weight_count);for(c=0,d=0;d<this.OZ;d++)h[c]=b[d],c++;for(d=0;d<this.OZ;d++)for(e=0;e<this.IZ;e++)for(f=0;f<this.WR;f++)for(g=0;g<this.WC;g++)h[c]=a[d][e][f][g],c++;return h},c.prototype.roll_weights=function(a){var b,c,d,e;b=this.OZ;var f=new Array(this.OZ);for(c=0;c<this.OZ;c++)for(f[c]=new Array(this.IZ),d=0;d<this.IZ;d++)for(f[c][d]=new Array(this.WR),e=0;e<this.WR;e++)f[c][d][e]=a.slice(b,b+this.WC),b+=this.WC;return f},c.prototype.roll_bias_weights=function(a){var b=a.slice(0,this.OZ);return b},c.prototype.set_weight=function(a,b,c){if(this.is_weight_bias(b))return void(this.bias_weights[b]=c);b-=this.OZ;var d,e,f,g;g=b%this.WC,f=Math.floor(b/this.WC)%this.WR,e=Math.floor(b/(this.WC*this.WR))%this.IZ,d=Math.floor(b/(this.WC*this.WR*this.IZ))%this.OZ,a[d][e][f][g]=c},c.prototype.get_weight=function(a,b){if(this.is_weight_bias(b))return this.bias_weights[b];b-=this.OZ;var c,d,e,f;return f=b%this.WC,e=Math.floor(b/this.WC)%this.WR,d=Math.floor(b/(this.WC*this.WR))%this.IZ,c=Math.floor(b/(this.WC*this.WR*this.IZ))%this.OZ,a[c][d][e][f]},c.prototype.is_weight_bias=function(a){return a<this.OZ},g.MaxPoolingLayer=d,g.max_pooling_layer_debug=!1,d.prototype.forward_propagation=function(a){var b=a.length;g.max_pooling_layer_debug&&(console.log("forward_propagation"),console.log("X:",a)),a=this.roll_matrix(a,[b,this.IZ,this.IR,this.IC]);var c,d,e,f,h,i,j,k,l,m=this.WR*this.WC;for(Z=new Array(b),A=new Array(b),c=0;b>c;c++)for(Z[c]=new Array(this.OZ),A[c]=new Array(this.OZ),e=0;e<this.IZ;e++)for(d=e,Z[c][d]=new Array(this.OR),A[c][d]=new Array(this.OR),i=0;i<this.OR;i++)for(Z[c][d][i]=new Array(this.OC),A[c][d][i]=new Array(this.OC),k=i*this.WR,j=0;j<this.OC;j++){for(l=j*this.WC,Z[c][e][i][j]=new Array(m),f=0;f<this.WR;f++)for(h=0;h<this.WC;h++)Z[c][d][i][j][h+f*this.WR]=a[c][e][k+f][l+h];A[c][d][i][j]=Math.max.apply(Math,Z[c][d][i][j]),Z[c][d][i][j]=Z[c][d][i][j].indexOf(A[c][d][i][j])}return A=this.unroll_matrix(A,[b,this.OZ,this.OR,this.OC]),Z=this.unroll_matrix(Z,[b,this.OZ,this.OR,this.OC]),g.max_pooling_layer_debug&&(console.log("Z:",Z),console.log("A:",A)),{A:A,Z:Z}},d.prototype.backward_propagation=function(a,b,c,d){var e=a.length;g.max_pooling_layer_debug&&(console.log("backward_propagation"),console.log("D:",a),console.log("ZP:",b),console.log("Z:",c)),a=this.roll_matrix(a,[e,this.OZ,this.OR,this.OC]),b=this.roll_matrix(b,[e,this.OZ,this.OR,this.OC]),c=this.roll_matrix(c,[e,this.IZ,this.IR,this.IC]);var f,h,i,j,k,l,m,n,o,p,q,r,s,t=new Array(e);for(f=0;e>f;f++){for(t[f]=new Array(this.IZ),h=0;h<this.IZ;h++)for(t[f][h]=new Array(this.IR),i=0;i<this.IR;i++)t[f][h][i]=new Array(this.IC).fill(0);for(h=0;h<this.IZ;h++)for(m=h,k=0;k<this.WR;k++)for(l=0;l<this.WC;l++)for(n=0;n<this.OR;n++)for(q=n*this.WR,o=0;o<this.OC;o++)p=o*this.WC,r=b[f][m][n][o],s=l+k*this.WR,r===s?t[f][h][q+k][p+l]=a[f][m][n][o]:t[f][h][q+k][p+l]=0;if(d)for(h=0;h<this.IZ;h++)for(i=0;i<this.IR;i++)for(j=1;j<this.IC;j++)t[f][h][i][j]*=d(c[f][h][i][j])}return t=this.unroll_matrix(t,[e,this.IZ,this.IR,this.IC]),g.max_pooling_layer_debug&&console.log("DM:",t),t},d.prototype.unroll_matrix=function(a,b){for(var c=new Array(b[0]),d=0,e=0;e<b[0];e++){c[e]=new Array(b[1]*b[2]*b[3]);for(var f=0;f<b[1];f++)for(var g=0;g<b[2];g++)for(var h=0;h<b[3];h++)c[e][d]=a[e][f][g][h],d++;d=0}return c},d.prototype.roll_matrix=function(a,b){for(var c=new Array(b[0]),d=0,e=0;e<b[0];e++){c[e]=new Array(b[1]);for(var f=0;f<b[1];f++){c[e][f]=new Array(b[2]);for(var g=0;g<b[2];g++)c[e][f][g]=a[e].slice(d,d+b[3]),d+=b[3]}d=0}return c},g.NeuralNetwork=e,g.neural_network_debug=!1,e.prototype.add_layer=function(a){this.layers[this.layer_count]=a,this.layer_count++},e.prototype.predict=function(a){var b=this.forward_propagation([a]).A[this.layer_count];return b[0]},e.prototype.compute_cost=function(a,b,c){var d,e,f,h,i=new Array(this.layer_count+1),j=new Array(this.layer_count),k=new Array(this.layer_count);return d=this.forward_propagation(a),i=d.A,j=d.Z,h=i[this.layer_count],d=this.backward_propagation(i,j,b),k=d.D,e=this.cost_f(h,b),g.neural_network_debug&&(console.log("cost function"),console.log("J:",e)),f=this.compute_gradient(k,i),this.regularize(e,f,c,a.length)},e.prototype.compute_gradient=function(a,b){var c,d=this.layer_count,e=new Array(d);for(c=0;d>c;c++)this.layers[c].has_weights&&(e[c]=this.layers[c].compute_gradient(a[c],b[c]));return e},e.prototype.check_gradient=function(a,b,c){var d,e,f,g,h,i,j,k=this.layer_count;for(g=this.compute_cost(a,b,0).grad,d=0;k>d;d++)if(this.layers[d].has_weights)for(e=0;e<this.layers[d].weight_count;e++)f=this.layers[d].get_weight(this.layers[d].weights,e),this.layers[d].set_weight(this.layers[d].weights,e,f-c),h=this.compute_cost(a,b,0).J,this.layers[d].set_weight(this.layers[d].weights,e,f+c),i=this.compute_cost(a,b,0).J,this.layers[d].set_weight(this.layers[d].weights,e,f),j=(i-h)/(2*c),real_grad=g[d][e],(real_grad!==j||0!==j)&&Math.abs(real_grad-j)>2*c&&console.log("l:",d,"w:",e,"real_grad:",real_grad,"num_grad:",j);return!0},e.prototype.regularize=function(a,b,c,d){var e,f,g,h=this.layers.length,i={J:a,grad:b};if(0!==c){var j=0;for(e=0;h>e;e++)if(this.layers[e].has_weights)for(f=0;f<this.layers[e].weight_count;f++)this.layers[e].is_weight_bias(f)||(g=this.layers[e].get_weight(this.layers[e].weights,f),j+=g*g,b[e][f]=b[e][f]+c*g/d);i.J+=c*j/(2*d)}return i},e.prototype.forward_propagation=function(a){var b,c,d=this.layer_count,e=new Array(d),f=new Array(d+1);for(f[0]=a,b=0;d>b;b++)c=this.layers[b].forward_propagation(f[b]),e[b]=c.Z,f[b+1]=c.A;return{A:f,Z:e}},e.prototype.backward_propagation=function(a,b,c){var d,e=this.layer_count;for(D=new Array(e),d=e-1;d>=0;d--)d===e-1?(D[d]=this.cost_f_derivative(a[d+1],c,b[d],this.layers[d].activation_f_derivative),g.neural_network_debug&&(console.log("backward_propagation last layer"),console.log("A:",a[d+1]),console.log("Y:",c),console.log("Z:",b[d]),console.log("D:",D[d]))):D[d]=this.layers[d+1].backward_propagation(D[d+1],b[d+1],b[d],this.layers[d].activation_f_derivative);return{D:D}},e.prototype.weights_update=function(a,b){var c,d=this.layer_count;for(c=0;d>c;c++)this.layers[c].has_weights&&this.layers[c].weights_update(a[c],b)},g.GradientDescent=f,f.prototype.init_gradient_descent_ctx=function(){return{J:[],iter_count:0,divergence:!1,error:!1,message:"",execution_time:0}},f.prototype.perform_gradient_descent=function(a,b,c,d,e){var f=(new Date).getTime(),g=this.init_gradient_descent_ctx();this.config.feature_scalling&&(g=NN.ml_utils.feature_scalling(a),a=g.matrix,g.feature_scalling_parameters=g.feature_scalling_parameters);var h=this.gradient_step(a,b,this.config.alpha,this.config.lambda,c,d,e);g.J.push(h),g.iter_count++;var i=this.gradient_step(a,b,this.config.alpha,this.config.lambda,c,d,e);for(g.J.push(i),g.iter_count++;(Math.abs(h-i)>this.config.stop_criteria||g.iter_count<this.config.min_iter)&&g.iter_count<this.config.max_iter;){if(0>h-i){g.divergence=!0;break}h=i,i=this.gradient_step(a,b,this.config.alpha,this.config.lambda,c,d,e),g.J.push(i),g.iter_count++}var j=(new Date).getTime();return g.execution_time=j-f,g},f.prototype.batched_gradient_descent=function(a,b,c,d,e,f){var g=(new Date).getTime(),h=a||this.init_gradient_descent_ctx(),i=this.gradient_step(b,c,this.config.alpha,this.config.lambda,d,e,f);h.J.push(i),h.iter_count++;var j=(new Date).getTime();return h.execution_time+=j-g,h},f.prototype.gradient_step=function(a,b,c,d,e,f,g){var h=e[f](a,b,d);return e[g](h.grad,c),h.J},"undefined"!=typeof module&&module.exports&&(module.exports=g),g}();